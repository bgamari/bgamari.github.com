<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>bgamari.github.com - 802.11ac with ath10k</title>
    <link rel="stylesheet" type="text/css" href="../css/default.css" />
    <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  <body>
    <div id="container">
      <div id="content">
        <div id="sidebar">
          <nav>
            <h1>Navigation</h1>
            <ul>
              <li><a href="../index.html">Home</a></li>
              <li><a href="../posts.html">Blog</a></li>
              <li><a href="../research-agenda.html">Research agenda</a></li>
              <li><a href="../publications.html">Publications</a></li>
              <li><a href="../past-research.html">Past research</a></li>
              <li><a href="../media/cv.pdf">Curriculum Vitæ</a></li>
            </ul>
            <h1>Related Links</h1>
            <ul>
              <li><a href="http://goldnerlab.physics.umass.edu/wiki/">Research group</a></li>
              <li><a href="http://www.github.com/bgamari">Github</a></li>
            </ul>
          </nav>
        </div>

        <section id="main">
        <article>
    <h1>802.11ac with ath10k</h1>
    <header>
        <div class="meta">
            <time datetime="2015-11-28" class="pubdate">2015-11-28</time> | tagged with <ul class="tags"><li>wireless</li><li>ath10k</li></ul>
        </div>
    </header>

    <p>These are my notes from an attempt at bringing up an 802.11ac wireless adapter in master mode. Unfortunately, this attempt was largely a failure,</p>
<ol type="1">
<li>Two Android devices and a Roku were unable to see the network at all</li>
<li>Range was rather disappointing (largely due to the fact that I was operating at 5GHz)</li>
<li>Convincing the driver that in fact lived in Germany and could therefore initiate radiation on the 5GHz band required a great deal of fragile</li>
<li>Throughput was not worth the complexity that 802.11ac wrought</li>
</ol>
<p>This was with a Compex WLE600V5-27 adapter supported by the <a href="https://wireless.wiki.kernel.org/en/users/Drivers/ath10k">ath10k</a>.</p>
<h2 id="regulatory-things">Regulatory things</h2>
<p>Wireless regulation enforcement is necessarily <a href="https://wireless.wiki.kernel.org/en/developers/Regulatory/processing_rules">complex</a>. Unfortunately my card, like many others, was shipped from the factory with its EEPROM set for use in the United States. This is problematic since I live in Germany, which uses different radar detection scheme (ETSI) than that used in the US (which, as it turns out, doesn’t even appear to be supported by <code>ath10k</code>).</p>
<p><a href="http://pisarenko.net/blog/2015/05/05/updates-to-the-802-dot-11ac-guide/">Working around this</a> essentially amounts to replacing the regulatory database entry describing the US region with that of Germany.</p>
<pre><code>$ git clone git://git.kernel.org/pub/scm/linux/kernel/git/linville/wireless-regdb.git
$ cd wireless-regdb
$ openssl req -x509  -nodes -days 365 -sha256 -newkey rsa:2048 -keyout ben.pem -out ben.pem
$ DISTRO_PRIVKEY=ben.pem DISTRO_PUBKEY=ben.pem make
$ sudo PREFIX= make install</code></pre>
<p>Now modify <code>db.txt</code>.</p>
<pre><code>$ sudo apt-get install python-m2crypto libgcrypt11-dev
$ git clone git://git.kernel.org/pub/scm/linux/kernel/git/mcgrof/crda.git
$ cd crda
$ PUBKEY_DIR=/lib/crda/pubkeys RUNTIME_PUBKEY_DIR=$PUBKEY_DIR make
$ sudo PREFIX= make install
$ ln -s debian-example debian</code></pre>
<p>Add <code>CFLAGS := -fpic</code> to <code>debian/rules</code>.</p>
<h2 id="other-things-i-learned">Other things I learned</h2>
<p>Regarding the meaning of <code>vht_oper_centr_freq_seg0_idx</code> (see <a href="http://lists.infradead.org/pipermail/ath10k/2014-May/002190.html">here</a>):</p>
<blockquote>
<p>VHT requires a generic center frequency (or rather channel number in hostapd) to be provided. Since you have channel=36 then the center frequency for 80MHz bandwidth is 36+6 = 42.</p>
</blockquote>
</article>

        </section>
      </div>

      <footer id="footer">
        <span>Generated by <a href="http://jaspervdj.be/hakyll/index.html">Hakyll</a>.</span>
      </footer>
    </div>
  </body>
</html>

