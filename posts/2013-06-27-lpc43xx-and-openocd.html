<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>bgamari.github.com - Notes concerning LPC43xx and OpenOCD</title>
    <link rel="stylesheet" type="text/css" href="../css/default.css" />
    <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </head>
  <body>
    <div id="container">
      <div id="content">
        <div id="sidebar">
          <nav>
            <h1>Navigation</h1>
            <ul>
              <li><a href="../index.html">Home</a></li>
              <li><a href="../posts.html">Blog</a></li>
              <li><a href="../research-agenda.html">Research agenda</a></li>
              <li><a href="../publications.html">Publications</a></li>
              <li><a href="../past-research.html">Past research</a></li>
              <li><a href="../media/cv.pdf">Curriculum Vitæ</a></li>
            </ul>
            <h1>Related Links</h1>
            <ul>
              <li><a href="http://goldnerlab.physics.umass.edu/wiki/">Research group</a></li>
              <li><a href="http://www.github.com/bgamari">Github</a></li>
            </ul>
          </nav>
        </div>

        <section id="main">
        <article>
    <h1>Notes concerning LPC43xx and OpenOCD</h1>
    <header>
        <div class="meta">
            <time datetime="2013-06-27" class="pubdate">2013-06-27</time> | tagged with <ul class="tags"></ul>
        </div>
    </header>

    <p>The LPC43xx seems to be pretty finicky when it comes to its JTAG. interface. Here are a few things that I found helped in getting the LPC and OpenOCD to talk,</p>
<ul>
<li><p>I use a BusBlaster. The new <code>interfaces/ftdi/dp_busblaster.cfg</code> configuration uses OpenOCD’s new FTDI driver which seems to be much more reliable than the old <code>interfaces/busblaster.cfg</code> configuration.</p></li>
<li><p>The M0 target seems to <a href="http://comments.gmane.org/gmane.comp.debugging.openocd.devel/22732">screw up halt</a>. Workaround by disabling in <code>target/lpc4350.cfg</code>. (TODO: check whether this is still necessary)</p></li>
<li><p>Even then, <code>reset halt</code> appears to be broken. This appears to be due too SRST being asserted twice. Work around by commenting out,</p></li>
</ul>
<pre><code>	foreach t $targets {
		# C code needs to know if we expect to 'halt'
		if {[jtag tapisenabled [$t cget -chain-position]]} {
			$t arp_reset assert $halt
		}
	}</code></pre>
<p>and,</p>
<pre><code>	foreach t $targets {
		# Again, de-assert code needs to know if we 'halt'
		if {[jtag tapisenabled [$t cget -chain-position]]} {
			$t arp_reset deassert $halt
		}
	}</code></pre>
<p>in <code>target/startup.tcl</code></p>
<ul>
<li>the first use of GDB’s <code>load</code> command will jump into ROM</li>
</ul>
</article>

        </section>
      </div>

      <footer id="footer">
        <span>Generated by <a href="http://jaspervdj.be/hakyll/index.html">Hakyll</a>.</span>
      </footer>
    </div>
  </body>
</html>

